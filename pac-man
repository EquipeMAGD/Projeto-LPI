#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include <conio.h>

void barreira(int *x, int *y,int antgx,int antgy,int barra[20][20])
{
    if(barra[*x][*y]==1) *x=antgx;
    if(barra[*x][*y]==1) *x=antgx;
    if(barra[*x][*y]==1) *y=antgy;
    if(barra[*x][*y]==1) *y=antgy;
    if(*y==19) *y=0;
    else if(*y==0) *y=19;
    if(*x==0) *x=19;
    else if(*x==19) *x=0;
}

typedef struct coord
{
    int x, y;
} coord;

int main( )
{
    int barra[20][20];
    char matriz[20][20], c;
    int i, j, t=50,aux,auxy, ponto=0;
    coord cir, fan;
    cir.x=10;
    cir.y=10;


    for(i=0;i<20;i++)
        for(j=0;j<20;j++)
        barra[i][j]=0;

    for(i=0; i<20; i++){
        for(j=0; j<20; j++){

        if((i==0 || i==19) && i!=10 && j!=10 ){
                matriz[i][j]=219;barra[i][j]=1;
        }
        else if((j==0 || j==19) && i!=10 && j!= 10 ){
                matriz[i][j]=219;barra[i][j]=1;
        }
        else  if(i==5 && j == 7){
                matriz[i][j]=219;barra[i][j]=1;
                }
        else  matriz[i][j]=' ';

        }
    }
    matriz[cir.x][cir.y]=' ';
    while(1)
    {
        system("cls");
        auxy=cir.y;
        aux=cir.x;
        switch(c)
        {
            case 'w': cir.x-=1; break;
            case 's': cir.x+=1; break;
            case 'a': cir.y-=1; break;
            case 'd': cir.y+=1; break;
        }

       barreira(&cir.x,&cir.y,aux,auxy,barra);
        system("color 0E");
        printf("Pontuacao: %d\n", ponto);
        for(i=0; i<20; i++)
        {
            for(j=0; j<20; j++)
            {

                 if( matriz[i][j]=='*' && i==cir.x && j==cir.y)
                    {
                      ponto++; t=250;
                      matriz[i][j]=' ';
                      putchar(1);
                      }
                 else if( matriz[i][j]==' ' && i==cir.x && j==cir.y)
                 {
                     putchar(1);
                     t=0;
                 }

                 else printf("%c", matriz[i][j]);

            }
            putchar('\n');
        }
        if(t>0)Beep( t,200);
        else Sleep(300);
       if(kbhit()) c=getch();
    }
}
